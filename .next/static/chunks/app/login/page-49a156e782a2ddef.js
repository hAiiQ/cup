(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{7810:function(e,t,r){Promise.resolve().then(r.bind(r,8991))},9376:function(e,t,r){"use strict";var n=r(5475);r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}})},8991:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var n=r(7437),l=r(2265),o=r(9376),s=r(4362),a=r(7648);function i(){let[e,t]=(0,l.useState)({username:"",password:""}),[r,i]=(0,l.useState)(""),[u,d]=(0,l.useState)(!1),c=(0,o.useRouter)(),{login:h}=(0,s.a)(),m=async t=>{t.preventDefault(),i(""),d(!0);try{let t=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),credentials:"include"}),r=await t.json();t.ok&&r.token&&r.user?(h(r.token,r.user),c.push("/dashboard")):i(r.error||"Anmeldung fehlgeschlagen")}catch(e){console.error("Login error:",e),i("Ein Fehler ist aufgetreten")}finally{d(!1)}};return(0,n.jsx)("div",{className:"min-h-screen bg-image flex items-center justify-center px-4",children:(0,n.jsxs)("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-8 w-full max-w-md border border-white/20",children:[(0,n.jsxs)("div",{className:"text-center mb-8",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"Anmelden"}),(0,n.jsx)("p",{className:"text-white/80",children:"Melde dich in deinem Account an"})]}),(0,n.jsxs)("form",{onSubmit:m,className:"space-y-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"username",className:"block text-white mb-2",children:"Benutzername"}),(0,n.jsx)("input",{type:"text",id:"username",required:!0,className:"w-full px-4 py-3 rounded-lg bg-white/20 border border-white/30 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Dein Benutzername",value:e.username,onChange:r=>t({...e,username:r.target.value})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"password",className:"block text-white mb-2",children:"Passwort"}),(0,n.jsx)("input",{type:"password",id:"password",required:!0,className:"w-full px-4 py-3 rounded-lg bg-white/20 border border-white/30 text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Dein Passwort",value:e.password,onChange:r=>t({...e,password:r.target.value})})]}),r&&(0,n.jsx)("div",{className:"bg-red-500/20 border border-red-500/30 rounded-lg p-3 text-red-200",children:r}),(0,n.jsx)("button",{type:"submit",disabled:u,className:"w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white py-3 rounded-lg font-semibold hover:from-purple-700 hover:to-pink-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Wird angemeldet...":"Anmelden"})]}),(0,n.jsx)("div",{className:"text-center mt-6",children:(0,n.jsxs)("p",{className:"text-white/80",children:["Noch keinen Account?"," ",(0,n.jsx)(a.default,{href:"/register",className:"text-purple-300 hover:text-purple-200 font-semibold",children:"Hier registrieren"})]})})]})})}},4362:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return a},a:function(){return s}});var n=r(7437),l=r(2265);let o=(0,l.createContext)(void 0),s=()=>{let e=(0,l.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},a=e=>{let{children:t}=e,[r,s]=(0,l.useState)(null),[a,i]=(0,l.useState)(null),[u,d]=(0,l.useState)(!1),[c,h]=(0,l.useState)(!0),m=async()=>{let e=localStorage.getItem("token");if(!e){s(null),i(null),d(!1),h(!1);return}i(e);try{let t=await fetch("/api/user/profile",{headers:{Authorization:"Bearer ".concat(e)},credentials:"include"});if(t.ok){let e=await t.json();e.success&&e.user?(s(e.user),d(!0)):(localStorage.removeItem("token"),s(null),i(null),d(!1))}else localStorage.removeItem("token"),s(null),i(null),d(!1)}catch(e){console.error("Auth refresh error:",e),localStorage.removeItem("token"),s(null),i(null),d(!1)}finally{h(!1)}},p=async()=>{localStorage.removeItem("token"),i(null),s(null),d(!1);try{await fetch("/api/auth/logout",{method:"POST",credentials:"include"})}catch(e){console.error("Logout API error:",e)}window.dispatchEvent(new Event("authChange"))};return(0,l.useEffect)(()=>{m();let e=()=>{m()};return window.addEventListener("authChange",e),window.addEventListener("storage",e),()=>{window.removeEventListener("authChange",e),window.removeEventListener("storage",e)}},[]),(0,n.jsx)(o.Provider,{value:{user:r,token:a,isLoggedIn:u,loading:c,login:(e,t)=>{localStorage.setItem("token",e),i(e),s(t),d(!0),window.dispatchEvent(new Event("authChange"))},logout:p,refreshUser:m},children:t})}}},function(e){e.O(0,[648,971,117,744],function(){return e(e.s=7810)}),_N_E=e.O()}]);