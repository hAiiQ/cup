(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[427],{29:function(e,t,s){Promise.resolve().then(s.bind(s,6764))},9376:function(e,t,s){"use strict";var a=s(5475);s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}})},6764:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return l}});var a=s(7437),r=s(2265),i=s(9376),n=s(7648);function l(){let[e,t]=(0,r.useState)([]),[s,l]=(0,r.useState)({totalUsers:0,verifiedUsers:0,unverifiedUsers:0}),[d,c]=(0,r.useState)(!0),[o,m]=(0,r.useState)("users"),[h,x]=(0,r.useState)(null),g=(0,i.useRouter)();(0,r.useEffect)(()=>{u()},[]);let u=async()=>{try{let[e,s]=await Promise.all([fetch("/api/admin/users"),fetch("/api/admin/stats")]);if(401===e.status||401===s.status){console.log("Admin not authenticated, redirecting to login..."),g.push("/admin");return}if(e.ok){let s=await e.json();t(s.users||[])}else console.error("Failed to fetch users:",e.status),t([]);if(s.ok){let e=await s.json();l(e)}else console.error("Failed to fetch stats:",s.status),l({totalUsers:0,verifiedUsers:0,unverifiedUsers:0})}catch(e){console.error("Error fetching data:",e),t([]),l({totalUsers:0,verifiedUsers:0,unverifiedUsers:0})}finally{c(!1)}},p=async()=>{await fetch("/api/admin/logout",{method:"POST"}),g.push("/admin")},f=async(e,s)=>{if(confirm('Bist du sicher, dass du den Benutzer "'.concat(s,'" l\xf6schen m\xf6chtest? Diese Aktion kann nicht r\xfcckg\xe4ngig gemacht werden.'))){x(e);try{let a=await fetch("/api/admin/users/".concat(e),{method:"DELETE",headers:{"Content-Type":"application/json"}});if(a.ok)t(t=>t.filter(t=>t.id!==e)),await u(),alert('Benutzer "'.concat(s,'" wurde erfolgreich gel\xf6scht.'));else{let e=await a.json();alert(e.error||"Fehler beim L\xf6schen des Users")}}catch(e){console.error("Error deleting user:",e),alert("Ein Fehler ist aufgetreten beim L\xf6schen des Users")}finally{x(null)}}},b=async(e,s,a)=>{try{(await fetch("/api/admin/users/".concat(e,"/social-verification"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({platform:s,verified:!a})})).ok?t(t=>t.map(t=>t.id===e?{...t,["".concat(s,"Verified")]:!a,isVerified:"twitch"===s?!a:t.twitchVerified&&"instagram"===s?!a:t.instagramVerified&&"discord"===s?!a:t.discordVerified}:t)):alert("Fehler beim Aktualisieren der Verifikation")}catch(e){alert("Ein Fehler ist aufgetreten")}},y=async(e,s)=>{try{(await fetch("/api/admin/users/".concat(e,"/tier"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tier:s})})).ok?t(t=>t.map(t=>t.id===e?{...t,tier:s}:t)):alert("Fehler beim Aktualisieren des Tiers")}catch(e){alert("Ein Fehler ist aufgetreten")}},N=async(e,t)=>{try{let s=await fetch("/api/admin/users/".concat(e,"/team"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teamName:t})});if(s.ok)await u();else{let e=await s.json();alert(e.error||"Fehler beim Aktualisieren der Team-Zuweisung")}}catch(e){alert("Ein Fehler ist aufgetreten")}},j=async e=>{try{let s=await fetch("/api/admin/toggle-streamer",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e})});if(s.ok){let a=await s.json();t(t=>t.map(t=>t.id===e?{...t,isStreamer:a.isStreamer}:t))}else alert("Fehler beim Aktualisieren des Streamer Status")}catch(e){alert("Ein Fehler ist aufgetreten")}};return d?(0,a.jsx)("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:(0,a.jsx)("div",{className:"text-white text-xl",children:"Lade Admin Dashboard..."})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-900",children:[(0,a.jsx)("header",{className:"bg-gray-800 border-b border-gray-700",children:(0,a.jsx)("div",{className:"container mx-auto px-4 py-4",children:(0,a.jsxs)("nav",{className:"flex justify-between items-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-red-400",children:"\uD83D\uDD12 ADMIN PANEL"}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"Administrator"}),(0,a.jsx)("button",{onClick:p,className:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 transition-colors",children:"Abmelden"})]})]})})}),(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"flex space-x-1 mb-8",children:[(0,a.jsx)("button",{onClick:()=>m("overview"),className:"px-6 py-3 rounded-lg font-semibold transition-colors ".concat("overview"===o?"bg-red-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:"\xdcbersicht"}),(0,a.jsx)("button",{onClick:()=>m("users"),className:"px-6 py-3 rounded-lg font-semibold transition-colors ".concat("users"===o?"bg-red-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:"User Management"}),(0,a.jsx)(n.default,{href:"/admin/wheel",className:"px-6 py-3 rounded-lg font-semibold bg-purple-600 text-white hover:bg-purple-700 transition-colors",children:"\uD83C\uDFAF Gl\xfccksrad"}),(0,a.jsx)(n.default,{href:"/admin/bracket",className:"px-6 py-3 rounded-lg font-semibold bg-blue-600 text-white hover:bg-blue-700 transition-colors",children:"\uD83C\uDFC6 Tournament Bracket"})]}),"overview"===o&&(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold text-white",children:"Dashboard \xdcbersicht"}),(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-white mb-2",children:"Registrierte User"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-blue-400",children:s.totalUsers})]}),(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-white mb-2",children:"Verifizierte User"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-green-400",children:s.verifiedUsers})]}),(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-white mb-2",children:"Warten auf Verifikation"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-yellow-400",children:s.unverifiedUsers})]})]}),(0,a.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold text-white mb-4",children:"Schnellzugriff"}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,a.jsxs)(n.default,{href:"/admin/wheel",className:"bg-purple-600 text-white p-4 rounded-lg hover:bg-purple-700 transition-colors text-center",children:[(0,a.jsx)("div",{className:"text-2xl mb-2",children:"\uD83C\uDFAF"}),(0,a.jsx)("div",{className:"font-semibold",children:"Gl\xfccksrad"}),(0,a.jsx)("div",{className:"text-sm opacity-80",children:"User zu Teams zuweisen"})]}),(0,a.jsxs)(n.default,{href:"/admin/bracket",className:"bg-blue-600 text-white p-4 rounded-lg hover:bg-blue-700 transition-colors text-center",children:[(0,a.jsx)("div",{className:"text-2xl mb-2",children:"\uD83C\uDFC6"}),(0,a.jsx)("div",{className:"font-semibold",children:"Tournament Bracket"}),(0,a.jsx)("div",{className:"text-sm opacity-80",children:"Matches verwalten"})]})]})]})]}),"users"===o&&(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold text-white",children:"User Management"}),(0,a.jsx)("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-700",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-left p-4 text-gray-300",children:"Username"}),(0,a.jsx)("th",{className:"text-left p-4 text-gray-300",children:"In-Game Name"}),(0,a.jsx)("th",{className:"text-left p-4 text-gray-300",children:"Rank"}),(0,a.jsx)("th",{className:"text-left p-4 text-gray-300",children:"Tier & Status"}),(0,a.jsx)("th",{className:"text-left p-4 text-gray-300",children:"Team"}),(0,a.jsx)("th",{className:"text-left p-4 text-gray-300",children:"Twitch"}),(0,a.jsx)("th",{className:"text-left p-4 text-gray-300",children:"Instagram"}),(0,a.jsx)("th",{className:"text-left p-4 text-gray-300",children:"Discord"}),(0,a.jsx)("th",{className:"text-left p-4 text-gray-300",children:"Status"}),(0,a.jsx)("th",{className:"text-left p-4 text-gray-300",children:"Aktionen"})]})}),(0,a.jsx)("tbody",{children:e.map(e=>(0,a.jsxs)("tr",{className:"border-t border-gray-700",children:[(0,a.jsx)("td",{className:"p-4 text-white",children:e.username}),(0,a.jsx)("td",{className:"p-4",children:(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-gray-300 text-sm",children:e.inGameName||"-"}),e.inGameName&&(0,a.jsx)("button",{onClick:()=>b(e.id,"inGameName",e.inGameNameVerified),className:"px-2 py-1 rounded text-xs font-medium transition-colors ".concat(e.inGameNameVerified?"bg-green-600 text-white hover:bg-green-700":"bg-gray-600 text-gray-300 hover:bg-gray-500"),children:e.inGameNameVerified?"✅ Verifiziert":"⏳ Ausstehend"})]})}),(0,a.jsx)("td",{className:"p-4",children:(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-gray-300 text-sm",children:e.inGameRank||"-"}),e.inGameRank&&(0,a.jsx)("button",{onClick:()=>b(e.id,"inGameRank",e.inGameRankVerified),className:"px-2 py-1 rounded text-xs font-medium transition-colors ".concat(e.inGameRankVerified?"bg-green-600 text-white hover:bg-green-700":"bg-gray-600 text-gray-300 hover:bg-gray-500"),children:e.inGameRankVerified?"✅ Verifiziert":"⏳ Ausstehend"})]})}),(0,a.jsx)("td",{className:"p-4",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex flex-wrap gap-1",children:[(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs font-semibold ".concat("tier1"===e.tier?"bg-blue-600 text-white":"tier2"===e.tier?"bg-green-600 text-white":"tier3"===e.tier?"bg-yellow-600 text-white":"bg-gray-600 text-gray-300"),children:e.tier?e.tier.toUpperCase():"KEIN TIER"}),e.isStreamer&&(0,a.jsx)("span",{className:"px-2 py-1 rounded text-xs font-semibold bg-purple-600 text-white",children:"\uD83C\uDFA5 STREAMER"})]}),(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsxs)("select",{value:e.tier||"",onChange:t=>y(e.id,t.target.value),className:"bg-gray-700 border border-gray-600 rounded text-xs text-white px-2 py-1 focus:outline-none focus:border-blue-500 flex-1",children:[(0,a.jsx)("option",{value:"",children:"Kein Tier"}),(0,a.jsx)("option",{value:"tier1",children:"Tier 1"}),(0,a.jsx)("option",{value:"tier2",children:"Tier 2"}),(0,a.jsx)("option",{value:"tier3",children:"Tier 3"})]}),(0,a.jsx)("button",{onClick:()=>j(e.id),className:"px-2 py-1 rounded text-xs font-medium transition-colors ".concat(e.isStreamer?"bg-purple-600 text-white hover:bg-purple-700":"bg-gray-600 text-gray-300 hover:bg-gray-500"),title:e.isStreamer?"Streamer Status entfernen":"Als Streamer markieren",children:"\uD83C\uDFA5"})]})]})}),(0,a.jsx)("td",{className:"p-4",children:(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-gray-300 text-sm",children:e.teamMemberships&&e.teamMemberships.length>0?e.teamMemberships[0].team.name:"Kein Team"}),(0,a.jsxs)("select",{value:e.teamMemberships&&e.teamMemberships.length>0?e.teamMemberships[0].team.name:"",onChange:t=>N(e.id,t.target.value),className:"bg-gray-700 border border-gray-600 rounded text-xs text-white px-2 py-1 focus:outline-none focus:border-blue-500",children:[(0,a.jsx)("option",{value:"",children:"Kein Team"}),(0,a.jsx)("option",{value:"Team Alpha",children:"Team Alpha"}),(0,a.jsx)("option",{value:"Team Beta",children:"Team Beta"}),(0,a.jsx)("option",{value:"Team Gamma",children:"Team Gamma"}),(0,a.jsx)("option",{value:"Team Delta",children:"Team Delta"}),(0,a.jsx)("option",{value:"Team Epsilon",children:"Team Epsilon"}),(0,a.jsx)("option",{value:"Team Zeta",children:"Team Zeta"}),(0,a.jsx)("option",{value:"Team Eta",children:"Team Eta"}),(0,a.jsx)("option",{value:"Team Theta",children:"Team Theta"})]})]})}),(0,a.jsx)("td",{className:"p-4",children:(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-gray-300 text-sm",children:e.twitchName||"-"}),e.twitchName&&(0,a.jsx)("button",{onClick:()=>b(e.id,"twitch",e.twitchVerified),className:"px-2 py-1 rounded text-xs font-medium transition-colors ".concat(e.twitchVerified?"bg-green-600 text-white hover:bg-green-700":"bg-gray-600 text-gray-300 hover:bg-gray-500"),children:e.twitchVerified?"✅ Verifiziert":"⏳ Ausstehend"})]})}),(0,a.jsx)("td",{className:"p-4",children:(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-gray-300 text-sm",children:e.instagramName||"-"}),e.instagramName&&(0,a.jsx)("button",{onClick:()=>b(e.id,"instagram",e.instagramVerified),className:"px-2 py-1 rounded text-xs font-medium transition-colors ".concat(e.instagramVerified?"bg-green-600 text-white hover:bg-green-700":"bg-gray-600 text-gray-300 hover:bg-gray-500"),children:e.instagramVerified?"✅ Verifiziert":"⏳ Ausstehend"})]})}),(0,a.jsx)("td",{className:"p-4",children:(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-gray-300 text-sm",children:e.discordName||"-"}),e.discordName&&(0,a.jsx)("button",{onClick:()=>b(e.id,"discord",e.discordVerified),className:"px-2 py-1 rounded text-xs font-medium transition-colors ".concat(e.discordVerified?"bg-green-600 text-white hover:bg-green-700":"bg-gray-600 text-gray-300 hover:bg-gray-500"),children:e.discordVerified?"✅ Verifiziert":"⏳ Ausstehend"})]})}),(0,a.jsx)("td",{className:"p-4",children:(()=>{let t=e.twitchName||e.instagramName||e.discordName,s=e.inGameName||e.inGameRank,r=(!e.twitchName||e.twitchVerified)&&(!e.instagramName||e.instagramVerified)&&(!e.discordName||e.discordVerified),i=(!e.inGameName||e.inGameNameVerified)&&(!e.inGameRank||e.inGameRankVerified),n=e.twitchVerified||e.instagramVerified||e.discordVerified||e.inGameNameVerified||e.inGameRankVerified;return t||s?r&&i?(0,a.jsx)("span",{className:"bg-green-600 text-white px-2 py-1 rounded text-sm",children:"Vollst\xe4ndig verifiziert"}):n?(0,a.jsx)("span",{className:"bg-yellow-600 text-white px-2 py-1 rounded text-sm",children:"Teilweise verifiziert"}):(0,a.jsx)("span",{className:"bg-red-600 text-white px-2 py-1 rounded text-sm",children:"Nicht verifiziert"}):(0,a.jsx)("span",{className:"bg-gray-600 text-white px-2 py-1 rounded text-sm",children:"Keine Infos"})})()}),(0,a.jsx)("td",{className:"p-4",children:(0,a.jsx)("div",{className:"flex space-x-2",children:(0,a.jsx)("button",{onClick:()=>f(e.id,e.username),disabled:h===e.id,className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 disabled:bg-gray-600 disabled:cursor-not-allowed flex items-center space-x-1",children:h===e.id?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-3 h-3 border border-white border-t-transparent rounded-full animate-spin"}),(0,a.jsx)("span",{children:"..."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:"\uD83D\uDDD1️"}),(0,a.jsx)("span",{children:"L\xf6schen"})]})})})})]},e.id))})]})})})]})]})]})}}},function(e){e.O(0,[648,971,117,744],function(){return e(e.s=29)}),_N_E=e.O()}]);