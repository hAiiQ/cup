(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[530],{7320:function(e,t,r){Promise.resolve().then(r.bind(r,9879))},9376:function(e,t,r){"use strict";var l=r(5475);r.o(l,"useRouter")&&r.d(t,{useRouter:function(){return l.useRouter}})},9879:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var l=r(7437),s=r(2265),a=r(9376);function i(){var e;let[t,r]=(0,s.useState)([]),[i,n]=(0,s.useState)([]),[d,o]=(0,s.useState)([]),[c,x]=(0,s.useState)("all"),[u,h]=(0,s.useState)("all"),[m,g]=(0,s.useState)(""),[b,f]=(0,s.useState)(!1),[p,N]=(0,s.useState)(null),[j,v]=(0,s.useState)(0),w=(0,s.useRef)(null),y=(0,s.useRef)(null),F=(0,a.useRouter)();(0,s.useEffect)(()=>{D()},[]),(0,s.useEffect)(()=>{C()},[t,c,u]),(0,s.useEffect)(()=>{E()},[d,j]);let D=async()=>{try{let[e,t]=await Promise.all([fetch("/api/admin/wheel/users"),fetch("/api/admin/wheel/teams")]);if(401===e.status||401===t.status){F.push("/admin");return}if(e.ok){let t=await e.json();r(t.users||[])}if(t.ok){let e=await t.json();n(e.teams||[])}}catch(e){console.error("Error fetching data:",e)}},C=()=>{let e=t;e="all"===c?t.filter(e=>e.tier&&["tier1","tier2","tier3"].includes(e.tier)):t.filter(e=>e.tier===c),"streamers"===u?e=e.filter(e=>!0===e.isStreamer):"non-streamers"===u&&(e=e.filter(e=>!1===e.isStreamer)),o(e)},E=()=>{let e=w.current;if(!e||0===d.length)return;let t=e.getContext("2d");if(!t)return;let r=e.width/2,l=e.height/2,s=Math.min(r,l)-10;t.clearRect(0,0,e.width,e.height);let a=2*Math.PI/d.length;d.forEach((e,i)=>{let n=i*a-Math.PI/2+j*Math.PI/180,d=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7","#DDA0DD","#98D8C8","#FFB347"],o=d[i%d.length];t.fillStyle=o,t.beginPath(),t.moveTo(r,l),t.arc(r,l,s,n,(i+1)*a-Math.PI/2+j*Math.PI/180),t.closePath(),t.fill();let c=.7*s;t.save(),t.translate(r,l),t.rotate(n+a/2),t.fillStyle="#FFFFFF",t.font="bold 16px Arial",t.textAlign="right",t.textBaseline="middle";let x=e.username.length>12?e.username.substring(0,10)+"..":e.username;t.fillText(x,c,0),e.isStreamer&&t.fillText("\uD83C\uDFA5",c-80,0),t.restore()}),t.fillStyle="#2C3E50",t.beginPath(),t.arc(r,l,40,0,2*Math.PI),t.fill(),t.strokeStyle="#FFFFFF",t.lineWidth=4,t.stroke(),t.fillStyle="#FFFFFF",t.font="bold 24px Arial",t.textAlign="center",t.textBaseline="middle",t.fillText("\uD83C\uDFAF",r,l)},A=async()=>{if(p&&m)try{let e=await fetch("/api/admin/wheel/assign",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:p.id,teamId:m})});if(e.ok)r(t.filter(e=>e.id!==p.id)),N(null),await D();else{let t=await e.json();alert("Fehler: "+t.error)}}catch(e){alert("Ein Fehler ist aufgetreten")}};(0,s.useEffect)(()=>()=>{y.current&&cancelAnimationFrame(y.current)},[]);let S=i.filter(e=>e.memberCount<6);return(0,l.jsxs)("div",{className:"min-h-screen bg-gray-900",children:[(0,l.jsx)("header",{className:"bg-gray-800 border-b border-gray-700",children:(0,l.jsx)("div",{className:"container mx-auto px-4 py-4",children:(0,l.jsxs)("nav",{className:"flex justify-between items-center",children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-purple-400",children:"\uD83C\uDFAF WHEEL OF NAMES STYLE"}),(0,l.jsx)("button",{onClick:()=>F.push("/admin/dashboard"),className:"bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700 transition-colors",children:"Zur\xfcck zum Dashboard"})]})})}),(0,l.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,l.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,l.jsxs)("div",{className:"text-center mb-8",children:[(0,l.jsx)("h1",{className:"text-4xl font-bold text-white mb-2",children:"\uD83C\uDFAF Wheel of Names Style"}),(0,l.jsx)("p",{className:"text-gray-400",children:"Exakt wie wheelofnames.com - garantiert korrekte Gewinner!"})]}),0===d.length&&(0,l.jsx)("div",{className:"bg-red-800/30 border border-red-600 rounded-xl p-6 mb-8",children:(0,l.jsxs)("div",{className:"flex items-center text-red-200",children:[(0,l.jsx)("span",{className:"text-3xl mr-4",children:"⚠️"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"font-bold text-lg mb-2",children:"Keine verf\xfcgbaren User"}),(0,l.jsx)("p",{children:"Es sind keine User mit den aktuellen Filtereinstellungen verf\xfcgbar."})]})]})}),(0,l.jsxs)("div",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700 mb-8",children:[(0,l.jsxs)("div",{className:"grid md:grid-cols-4 gap-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-gray-300 mb-2 font-semibold",children:"Tier Filter:"}),(0,l.jsxs)("select",{value:c,onChange:e=>x(e.target.value),className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[(0,l.jsxs)("option",{value:"all",children:["Alle Tiers (",t.filter(e=>e.tier&&["tier1","tier2","tier3"].includes(e.tier)).length," User)"]}),(0,l.jsxs)("option",{value:"tier1",children:["Tier 1 (",t.filter(e=>"tier1"===e.tier).length," User)"]}),(0,l.jsxs)("option",{value:"tier2",children:["Tier 2 (",t.filter(e=>"tier2"===e.tier).length," User)"]}),(0,l.jsxs)("option",{value:"tier3",children:["Tier 3 (",t.filter(e=>"tier3"===e.tier).length," User)"]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-gray-300 mb-2 font-semibold",children:"\uD83C\uDFA5 Streamer Filter:"}),(0,l.jsxs)("select",{value:u,onChange:e=>h(e.target.value),className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[(0,l.jsx)("option",{value:"all",children:"Alle User"}),(0,l.jsx)("option",{value:"streamers",children:"\uD83C\uDFA5 Nur Streamer"}),(0,l.jsx)("option",{value:"non-streamers",children:"\uD83D\uDC64 Keine Streamer"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-gray-300 mb-2 font-semibold",children:"Ziel Team:"}),(0,l.jsxs)("select",{value:m,onChange:e=>g(e.target.value),className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[(0,l.jsx)("option",{value:"",children:"Team ausw\xe4hlen..."}),S.map(e=>(0,l.jsxs)("option",{value:e.id,children:[e.name," (",e.memberCount,"/6)"]},e.id))]})]}),(0,l.jsx)("div",{className:"flex items-end",children:(0,l.jsx)("button",{onClick:()=>{if(0===d.length||!m||b)return;f(!0),N(null);let e=Math.floor(Math.random()*d.length),t=d[e];console.log("\uD83C\uDFAF PRE-SELECTED WINNER:",t.username,"at index",e);let r=360/d.length,l=e*r+270,s=l+r/2,a=(360-s%360)%360,i=8+4*Math.random(),n=360*i+a;console.log("\uD83C\uDFAF SPIN CALCULATION:",{winnerIndex:e,winnerSegmentStart:l.toFixed(1)+"\xb0",winnerSegmentMiddle:s.toFixed(1)+"\xb0",targetFinalAngle:a.toFixed(1)+"\xb0",extraRotations:i,totalRotation:n.toFixed(1)+"\xb0"});let o=Date.now(),c=()=>{let e=Math.min((Date.now()-o)/8e3,1);v((j+n*(1-Math.pow(1-e,3)))%360),e<1?y.current=requestAnimationFrame(c):(console.log("\uD83C\uDFAF SPIN COMPLETE - WINNER CONFIRMED:",t.username),N(t),f(!1))};y.current=requestAnimationFrame(c)},disabled:0===d.length||!m||b,className:"w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white py-3 px-6 rounded-lg font-semibold hover:from-purple-700 hover:to-pink-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed text-lg shadow-lg",children:b?"\uD83C\uDFAF SPINNING...":"\uD83C\uDFAF SPIN THE WHEEL!"})})]}),(0,l.jsx)("div",{className:"bg-green-800/30 border border-green-600 rounded-lg p-4 mt-6",children:(0,l.jsxs)("div",{className:"flex items-center text-green-200",children:[(0,l.jsx)("span",{className:"text-2xl mr-3",children:"✅"}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("p",{className:"font-semibold",children:["Verf\xfcgbar: ",d.length," User"]}),(0,l.jsx)("p",{className:"text-sm text-green-300",children:"Wheel of Names Algorithmus - 100% korrekt!"})]})]})})]}),(0,l.jsxs)("div",{className:"grid xl:grid-cols-3 gap-8",children:[(0,l.jsxs)("div",{className:"xl:col-span-2 flex flex-col items-center space-y-8",children:[(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("div",{className:"absolute -top-6 left-1/2 transform -translate-x-1/2 z-20",children:(0,l.jsx)("div",{className:"w-0 h-0 border-l-[20px] border-r-[20px] border-t-[30px] border-l-transparent border-r-transparent border-t-white shadow-xl drop-shadow-lg"})}),(0,l.jsx)("canvas",{ref:w,width:500,height:500,className:"rounded-full shadow-2xl"})]}),p&&!b&&(0,l.jsxs)("div",{className:"bg-gradient-to-br from-yellow-400 via-orange-500 to-red-500 rounded-2xl p-8 border-4 border-yellow-300 shadow-2xl max-w-lg w-full",children:[(0,l.jsx)("h3",{className:"text-4xl font-bold text-white mb-6 text-center drop-shadow-lg",children:"\uD83C\uDF89 WINNER!"}),(0,l.jsxs)("div",{className:"text-white space-y-4 text-center",children:[(0,l.jsxs)("div",{className:"text-3xl font-bold drop-shadow-lg",children:[p.isStreamer&&"\uD83C\uDFA5 ",p.username]}),(0,l.jsxs)("div",{className:"text-xl",children:[(0,l.jsx)("strong",{children:"In-Game:"})," ",p.inGameName||"Not specified"]}),(0,l.jsxs)("div",{className:"text-xl",children:[(0,l.jsx)("strong",{children:"Tier:"}),(0,l.jsx)("span",{className:"ml-2 px-4 py-2 rounded-full font-bold text-lg ".concat("tier1"===p.tier?"bg-blue-600":"tier2"===p.tier?"bg-green-600":"tier3"===p.tier?"bg-purple-600":"bg-gray-600"),children:null===(e=p.tier)||void 0===e?void 0:e.toUpperCase()})]})]}),(0,l.jsx)("button",{onClick:A,className:"mt-8 w-full bg-green-600 text-white px-8 py-4 rounded-xl hover:bg-green-700 transition-all font-bold text-2xl shadow-lg transform hover:scale-105",children:"✅ ADD TO TEAM"})]})]}),(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("h2",{className:"text-2xl font-bold text-white mb-4",children:["Available Users (",d.length,")"]}),(0,l.jsx)("div",{className:"bg-gray-800 rounded-xl border border-gray-700 max-h-96 overflow-y-auto",children:0===d.length?(0,l.jsxs)("div",{className:"p-6 text-gray-400 text-center",children:[(0,l.jsx)("div",{className:"text-4xl mb-3",children:"\uD83D\uDE14"}),(0,l.jsx)("p",{children:"No users available"})]}):(0,l.jsx)("div",{className:"p-4 space-y-2",children:d.map((e,t)=>{var r;return(0,l.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-700 rounded-lg hover:bg-gray-600 transition-colors border-l-4",style:{borderLeftColor:["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7","#DDA0DD","#98D8C8","#FFB347"][t%8]},children:[(0,l.jsxs)("div",{className:"text-white",children:[(0,l.jsxs)("div",{className:"font-semibold",children:[e.isStreamer&&"\uD83C\uDFA5 ",e.username]}),(0,l.jsx)("div",{className:"text-sm text-gray-300",children:e.inGameName||"No In-Game Name"})]}),(0,l.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold ".concat("tier1"===e.tier?"bg-blue-600 text-white":"tier2"===e.tier?"bg-green-600 text-white":"tier3"===e.tier?"bg-yellow-600 text-white":"bg-gray-600 text-white"),children:null===(r=e.tier)||void 0===r?void 0:r.toUpperCase()})]},e.id)})})})]}),(0,l.jsxs)("div",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700",children:[(0,l.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"Teams Overview"}),(0,l.jsx)("div",{className:"space-y-3",children:i.map(e=>(0,l.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-700 rounded-lg",children:[(0,l.jsx)("span",{className:"text-white font-medium",children:e.name}),(0,l.jsxs)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold ".concat(e.memberCount>=6?"bg-red-600 text-white":e.memberCount>=4?"bg-yellow-600 text-white":"bg-green-600 text-white"),children:[e.memberCount,"/6"]})]},e.id))})]})]})]})]})})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=7320)}),_N_E=e.O()}]);