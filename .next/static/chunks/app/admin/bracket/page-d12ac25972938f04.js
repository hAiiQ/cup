(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[263],{2454:function(e,t,a){Promise.resolve().then(a.bind(a,7846))},9376:function(e,t,a){"use strict";var s=a(5475);a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}})},7846:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return n}});var s=a(7437),r=a(2265),l=a(9376);function n(){let[e,t]=(0,r.useState)([]),[a,n]=(0,r.useState)([]),[i,c]=(0,r.useState)(!0),[o,d]=(0,r.useState)(null),[m,x]=(0,r.useState)({team1:0,team2:0}),h=(0,l.useRouter)();(0,r.useEffect)(()=>{u()},[]);let u=async()=>{try{console.log("\uD83D\uDD04 Admin fetchData started");let[a,s]=await Promise.all([fetch("/api/admin/teams"),fetch("/api/bracket/matches")]),r={teams:[]};if(a.ok){let e=(r=await a.json()).teams.sort((e,t)=>e.position-t.position);t(e),console.log("✅ Admin teams loaded:",e.length)}if(s.ok){var e;let t=await s.json();if(console.log("✅ Admin using bracket API matches:",(null===(e=t.matches)||void 0===e?void 0:e.length)||0),t.matches&&t.matches.length>0)n(t.matches),console.log("\uD83C\uDFAF Admin Bracket set from API:",t.matches.length,"matches"),console.log("\uD83C\uDFAF Winner Round 1 matches from API:",t.matches.filter(e=>"winner"===e.bracket&&1===e.round).length);else{let e=p(r.teams||[]);n(e),console.log("\uD83D\uDD25 Admin Fallback Bracket set:",e.length,"matches")}}else{let e=p(r.teams||[]);n(e),console.log("\uD83D\uDD25 Admin Fallback Bracket set (API failed):",e.length,"matches")}}catch(t){console.error("Error fetching data:",t);let e=p([]);n(e),console.log("\uD83D\uDD25 Admin Fallback Bracket set:",e.length,"matches")}finally{c(!1)}},p=e=>{let t=[],a=e.length>=8?e.slice(0,8):[{id:"alpha",name:"Team Alpha",position:1},{id:"beta",name:"Team Beta",position:2},{id:"gamma",name:"Team Gamma",position:3},{id:"delta",name:"Team Delta",position:4},{id:"echo",name:"Team Echo",position:5},{id:"foxtrot",name:"Team Foxtrot",position:6},{id:"golf",name:"Team Golf",position:7},{id:"hotel",name:"Team Hotel",position:8}];[{team1:a[0],team2:a[1]},{team1:a[2],team2:a[3]},{team1:a[4],team2:a[5]},{team1:a[6],team2:a[7]}].forEach((e,a)=>{t.push({id:"WB-Q".concat(a+1),round:1,matchNumber:a+1,team1:e.team1,team2:e.team2,team1Score:0,team2Score:0,isFinished:!1,bracket:"winner"})});for(let e=0;e<2;e++)t.push({id:"WB-S".concat(e+1),round:2,matchNumber:e+1,team1Score:0,team2Score:0,isFinished:!1,bracket:"winner"});t.push({id:"WB-F",round:3,matchNumber:1,team1Score:0,team2Score:0,isFinished:!1,bracket:"winner"});for(let e=0;e<2;e++)t.push({id:"LB-1-".concat(e+1),round:1,matchNumber:e+1,team1Score:0,team2Score:0,isFinished:!1,bracket:"loser"});for(let e=0;e<2;e++)t.push({id:"LB-2-".concat(e+1),round:2,matchNumber:e+1,team1Score:0,team2Score:0,isFinished:!1,bracket:"loser"});return t.push({id:"LB-3",round:3,matchNumber:1,team1Score:0,team2Score:0,isFinished:!1,bracket:"loser"}),t.push({id:"LB-F",round:4,matchNumber:1,team1Score:0,team2Score:0,isFinished:!1,bracket:"loser"}),t.push({id:"GF",round:4,matchNumber:1,team1Score:0,team2Score:0,isFinished:!1,bracket:"grand"}),t},b=async(e,t,a)=>{try{let s=await fetch("/api/admin/bracket/matches/update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({matchId:e,team1Score:t,team2Score:a})});if(s.ok){let r=await s.json();alert("✅ ".concat(r.message||"Match-Score gespeichert!")),d(null),n(s=>s.map(s=>s.id===e?{...s,team1Score:t,team2Score:a,isFinished:t>0||a>0}:s)),console.log("\uD83D\uDD04 Admin: Updated local match ".concat(e," scores: ").concat(t,"-").concat(a))}else alert("Fehler beim Speichern des Ergebnisses")}catch(e){console.error("Error updating match:",e),alert("Ein Fehler ist aufgetreten")}},g=async()=>{if(confirm("M\xf6chtest du wirklich das gesamte Tournament zur\xfccksetzen? Alle Ergebnisse gehen verloren!"))try{if((await fetch("/api/admin/bracket/reset",{method:"POST",headers:{"Content-Type":"application/json"}})).ok){let t=p(e);n(t),alert("Tournament erfolgreich zur\xfcckgesetzt!")}else alert("Fehler beim Zur\xfccksetzen des Tournaments")}catch(e){console.error("Error resetting tournament:",e),alert("Ein Fehler ist aufgetreten")}},f=(e,t)=>{let s=a.filter(a=>a.bracket===e&&a.round===t);return console.log("\uD83D\uDD0D Admin Bracket Filter: ".concat(e," round ").concat(t," → ").concat(s.length," matches"),s.map(e=>e.id)),s},N=()=>a.find(e=>"grand"===e.bracket),j=e=>{d(e),x({team1:e.team1Score,team2:e.team2Score})},v=e=>{var t,a;let{match:r,className:l=""}=e,i=(null==r?void 0:null===(t=r.team1)||void 0===t?void 0:t.name)||"TBD",c=(null==r?void 0:null===(a=r.team2)||void 0===a?void 0:a.name)||"TBD",o=r&&(r.team1Score>0||r.team2Score>0),d=(null==r?void 0:r.team1Score)||0,m=(null==r?void 0:r.team2Score)||0,x=(null==r?void 0:r.isLive)||!1,h=o&&d>m,u=o&&m>d,p=h?"text-green-400 font-bold":u?"text-gray-500":"text-white",b=u?"text-green-400 font-bold":h?"text-gray-500":"text-white",g=async e=>{if(e.stopPropagation(),r)try{let e=await fetch("/api/admin/bracket/matches/live",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({matchId:r.id,isLive:!x})});if(e.ok){let t=await e.json();alert("✅ ".concat(t.message||(x?"Match gestoppt":"Match gestartet"))),n(e=>e.map(e=>e.id===r.id?{...e,isLive:!x}:e)),console.log("\uD83D\uDD04 Admin: Updated local match ".concat(r.id," isLive to ").concat(!x))}else alert("Fehler beim \xc4ndern des Live-Status")}catch(e){console.error("Error toggling live status:",e),alert("Fehler beim \xc4ndern des Live-Status")}};return(0,s.jsxs)("div",{className:"bg-gray-700/90 border border-gray-600 rounded-lg p-3 w-full min-h-[80px] flex flex-col justify-center cursor-pointer hover:border-purple-500 transition-colors ".concat(x?"border-red-500 bg-red-900/20":""," ").concat(l),children:[r&&(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,s.jsx)("div",{className:"flex items-center space-x-2",children:x&&(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),(0,s.jsx)("span",{className:"text-red-400 text-xs font-bold",children:"LIVE"})]})}),(0,s.jsx)("button",{onClick:g,className:"px-2 py-1 text-xs rounded ".concat(x?"bg-red-600 text-white hover:bg-red-700":"bg-green-600 text-white hover:bg-green-700"),children:x?"STOP":"START"})]}),(0,s.jsx)("div",{className:"text-center text-sm font-medium flex-1 flex items-center justify-center",onClick:()=>r&&j(r),children:o?(0,s.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,s.jsx)("span",{className:"".concat(p),children:d}),(0,s.jsx)("span",{className:p,children:i}),(0,s.jsx)("span",{className:"text-white",children:"VS"}),(0,s.jsx)("span",{className:b,children:c}),(0,s.jsx)("span",{className:"".concat(b),children:m})]}):(0,s.jsxs)("div",{className:"text-white",children:[i," VS ",c]})})]})};return i?(0,s.jsx)("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:(0,s.jsx)("div",{className:"text-white text-xl",children:"Lade Tournament Bracket..."})}):(0,s.jsxs)("div",{className:"min-h-screen bg-image",children:[(0,s.jsx)("header",{className:"bg-gray-800 border-b border-gray-700",children:(0,s.jsx)("div",{className:"container mx-auto px-4 py-4",children:(0,s.jsxs)("nav",{className:"flex justify-between items-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-purple-400",children:"\uD83C\uDFC6 MARVEL RIVALS TOURNAMENT BRACKET (ADMIN)"}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("div",{className:"text-gray-300 text-sm",children:[e.length," Teams registriert"]}),(0,s.jsx)("div",{className:"text-green-400 text-sm font-semibold",children:"✓ Auto-Update aktiv"}),(0,s.jsx)("button",{onClick:g,className:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 transition-colors",children:"\uD83D\uDD04 Tournament zur\xfccksetzen"}),(0,s.jsx)("button",{onClick:()=>h.push("/admin/dashboard"),className:"bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700 transition-colors",children:"Zur\xfcck zum Dashboard"})]})]})})}),(0,s.jsxs)("div",{className:"w-full px-4 py-8",children:[(0,s.jsxs)("div",{className:"relative bg-black/20 backdrop-blur-sm rounded-xl p-6 border border-purple-500/50 w-full",children:[(0,s.jsx)("div",{className:"absolute",style:{top:"175px",left:"365px",zIndex:1},children:(0,s.jsx)("img",{src:"/lines.png",alt:"Bracket Lines",className:"select-none pointer-events-none",style:{userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",width:"auto",height:"auto",maxWidth:"none",maxHeight:"none"},draggable:!1})}),(0,s.jsxs)("div",{className:"w-full relative",style:{height:"600px"},children:[(0,s.jsxs)("div",{className:"absolute bg-black/30 rounded-lg border border-purple-500/30 p-4",style:{left:"21px",top:"135px",zIndex:2,width:"320px"},children:[(0,s.jsx)("div",{className:"bg-purple-600 text-white px-4 py-2 rounded-lg font-bold text-center w-full text-sm mb-3",children:"RUNDE 1 - STARTER BRACKET"}),(0,s.jsx)("div",{className:"space-y-2",children:f("winner",1).map((e,t)=>{let[a,r]=[["Team Alpha","Team Beta"],["Team Gamma","Team Delta"],["Team Echo","Team Foxtrot"],["Team Golf","Team Hotel"]][t]||["TBD","TBD"],l={...e,team1:e.team1||{id:"temp-team1-".concat(e.id),name:a,position:1},team2:e.team2||{id:"temp-team2-".concat(e.id),name:r,position:2}};return(0,s.jsx)("div",{onClick:()=>j(e),children:(0,s.jsx)(v,{match:l,className:"w-full h-auto"})},e.id)})})]}),(0,s.jsxs)("div",{className:"absolute bg-black/30 rounded-lg border border-purple-500/30 p-4",style:{left:"387px",top:"55px",zIndex:2,width:"320px"},children:[(0,s.jsx)("div",{className:"bg-purple-600 text-white px-4 py-2 rounded-lg font-bold text-center w-full text-sm mb-3",children:"RUNDE 2 - UPPER BRACKET"}),(0,s.jsx)("div",{className:"space-y-3",children:f("winner",2).map((e,t)=>(0,s.jsx)(v,{match:e},e.id))})]}),(0,s.jsxs)("div",{className:"absolute bg-black/30 rounded-lg border border-purple-500/30 p-4",style:{left:"1117px",top:"93px",zIndex:2,width:"320px"},children:[(0,s.jsx)("div",{className:"bg-purple-600 text-white px-4 py-2 rounded-lg font-bold text-center w-full text-sm mb-3",children:"RUNDE 5 - UPPER BRACKET"}),(0,s.jsx)("div",{children:f("winner",3).map(e=>(0,s.jsx)(v,{match:e},e.id))})]}),(0,s.jsxs)("div",{className:"absolute bg-black/30 rounded-lg border border-purple-500/30 p-4",style:{left:"387px",top:"323px",zIndex:2,width:"320px"},children:[(0,s.jsx)("div",{className:"bg-purple-700 text-white px-4 py-2 rounded-lg font-bold text-center w-full text-sm mb-3",children:"RUNDE 3 - LOWER BRACKET"}),(0,s.jsx)("div",{className:"space-y-3",children:f("loser",1).map(e=>(0,s.jsx)(v,{match:e},e.id))})]}),(0,s.jsxs)("div",{className:"absolute bg-black/30 rounded-lg border border-purple-500/30 p-4",style:{left:"752px",top:"323px",zIndex:2,width:"320px"},children:[(0,s.jsx)("div",{className:"bg-purple-700 text-white px-4 py-2 rounded-lg font-bold text-center w-full text-sm mb-3",children:"RUNDE 4 - LOWER BRACKET"}),(0,s.jsx)("div",{className:"space-y-3",children:f("loser",2).map(e=>(0,s.jsx)(v,{match:e},e.id))})]}),(0,s.jsxs)("div",{className:"absolute bg-black/30 rounded-lg border border-purple-500/30 p-4",style:{left:"1117px",top:"361px",zIndex:2,width:"320px"},children:[(0,s.jsx)("div",{className:"bg-purple-700 text-white px-4 py-2 rounded-lg font-bold text-center w-full text-sm mb-3",children:"RUNDE 6 - LOWER BRACKET"}),(0,s.jsx)("div",{children:f("loser",3).map(e=>(0,s.jsx)(v,{match:e},e.id))})]}),(0,s.jsxs)("div",{className:"absolute bg-black/30 rounded-lg border border-purple-500/30 p-4",style:{left:"1482px",top:"361px",zIndex:2,width:"320px"},children:[(0,s.jsx)("div",{className:"bg-purple-700 text-white px-4 py-2 rounded-lg font-bold text-center w-full text-sm mb-3",children:"RUNDE 7 - LOWER BRACKET FINALS"}),(0,s.jsx)("div",{children:f("loser",5).map(e=>(0,s.jsx)(v,{match:e},e.id))})]}),(0,s.jsxs)("div",{className:"absolute bg-black/30 rounded-lg border border-yellow-500/50 p-4",style:{left:"1482px",top:"93px",zIndex:2,width:"320px"},children:[(0,s.jsx)("div",{className:"bg-yellow-500 text-black px-4 py-2 rounded-lg font-bold text-center w-full text-sm mb-3 flex items-center justify-center",children:"RUNDE 8 - \uD83C\uDFC6 GRAND FINALS"}),(0,s.jsx)("div",{children:N()&&(0,s.jsx)(v,{match:N()})})]})]})]}),(0,s.jsxs)("div",{className:"mt-8",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-white text-center mb-4",children:"TEILNEHMENDE TEAMS"}),(0,s.jsx)("div",{className:"grid md:grid-cols-4 gap-3",children:e.length>=8?e.slice(0,8).map((e,t)=>(0,s.jsxs)("div",{className:"bg-purple-600/20 backdrop-blur-sm rounded-lg p-3 border border-purple-500/50",children:[(0,s.jsx)("h3",{className:"text-white font-semibold text-center text-base",children:e.name}),(0,s.jsxs)("p",{className:"text-purple-200 text-center text-xs",children:["Position ",e.position]})]},e.id)):["Team Alpha","Team Beta","Team Gamma","Team Delta","Team Echo","Team Foxtrot","Team Golf","Team Hotel"].map((e,t)=>(0,s.jsxs)("div",{className:"bg-purple-600/20 backdrop-blur-sm rounded-lg p-3 border border-purple-500/50",children:[(0,s.jsx)("h3",{className:"text-white font-semibold text-center text-base",children:e}),(0,s.jsxs)("p",{className:"text-purple-200 text-center text-xs",children:["Position ",t+1]})]},t))})]})]}),o&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 w-96 border border-gray-600",children:[(0,s.jsxs)("h3",{className:"text-xl font-bold text-white mb-4 text-center",children:["winner"===o.bracket?"Winner Bracket":"loser"===o.bracket?"Loser Bracket":"Grand Final"," - Round ",o.round," #",o.matchNumber]}),o.team1&&o.team2?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"block text-gray-300 font-semibold",children:o.team1.name}),(0,s.jsx)("input",{type:"number",min:"0",max:"3",value:m.team1,onChange:e=>x(t=>({...t,team1:parseInt(e.target.value)||0})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 text-white rounded focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"block text-gray-300 font-semibold",children:o.team2.name}),(0,s.jsx)("input",{type:"number",min:"0",max:"3",value:m.team2,onChange:e=>x(t=>({...t,team2:parseInt(e.target.value)||0})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 text-white rounded focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),(0,s.jsx)("div",{className:"text-center text-gray-400 text-sm",children:"Best of 3 - Erstes Team auf 2 Punkte gewinnt"}),(0,s.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,s.jsx)("button",{onClick:()=>b(o.id,m.team1,m.team2),className:"flex-1 bg-green-600 text-white py-2 rounded hover:bg-green-700 transition-colors font-semibold",children:"\uD83D\uDCBE Speichern"}),(0,s.jsx)("button",{onClick:()=>d(null),className:"flex-1 bg-red-600 text-white py-2 rounded hover:bg-red-700 transition-colors",children:"❌ Abbrechen"})]})]}):(0,s.jsxs)("div",{className:"text-center text-gray-400",children:[(0,s.jsx)("p",{children:"Teams noch nicht verf\xfcgbar"}),(0,s.jsx)("p",{className:"text-sm mt-2",children:"Vorherige Matches m\xfcssen erst abgeschlossen werden"}),(0,s.jsx)("button",{onClick:()=>d(null),className:"mt-4 bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700 transition-colors",children:"Schlie\xdfen"})]})]})})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=2454)}),_N_E=e.O()}]);