"use strict";(()=>{var e={};e.id=2672,e.ids=[2672],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8893:e=>{e.exports=require("buffer")},4770:e=>{e.exports=require("crypto")},6162:e=>{e.exports=require("stream")},1764:e=>{e.exports=require("util")},9942:(e,r,n)=>{n.r(r),n.d(r,{originalPathname:()=>D,patchFetch:()=>f,requestAsyncStorage:()=>p,routeModule:()=>m,serverHooks:()=>A,staticGenerationAsyncStorage:()=>g});var t={};n.r(t),n.d(t,{POST:()=>c,dynamic:()=>d});var o=n(9303),s=n(8716),i=n(670),a=n(7070),l=n(728),u=n(5456);let d="force-dynamic";async function c(e){try{console.log("\uD83D\uDD0D Admin login attempt started");let{username:r,password:n}=await e.json();if(console.log("\uD83D\uDCDD Admin login data received:",{username:r}),!r||!n)return console.log("❌ Missing username or password"),a.NextResponse.json({error:"Benutzername und Passwort sind erforderlich"},{status:400});console.log("\uD83D\uDD0D Searching for admin:",r);let t=await l._.admin.findUnique({where:{username:r}});if(console.log("\uD83D\uDC64 Admin found:",t?"YES":"NO"),!t)return console.log("❌ Admin not found"),a.NextResponse.json({error:"Ung\xfcltige Admin-Anmeldedaten"},{status:401});if(!await (0,u.Gv)(n,t.password))return a.NextResponse.json({error:"Ung\xfcltige Admin-Anmeldedaten"},{status:401});let o=(0,u.RA)(`admin_${t.id}`),s=a.NextResponse.json({message:"Admin-Anmeldung erfolgreich",admin:{id:t.id,username:t.username,role:t.role}});return s.cookies.set("admin_token",o,{httpOnly:!0,secure:!0,sameSite:"lax",maxAge:604800}),s}catch(e){return console.error("❌ Admin login error details:",e),console.error("❌ Admin login error stack:",e instanceof Error?e.stack:"No stack trace"),console.error("❌ Admin login error message:",e instanceof Error?e.message:String(e)),a.NextResponse.json({error:"Interner Serverfehler: "+(e instanceof Error?e.message:String(e))},{status:500})}}let m=new o.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/admin/login/route",pathname:"/api/admin/login",filename:"route",bundlePath:"app/api/admin/login/route"},resolvedPagePath:"C:\\Users\\hAiQ\\Desktop\\cup\\src\\app\\api\\admin\\login\\route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:p,staticGenerationAsyncStorage:g,serverHooks:A}=m,D="/api/admin/login/route";function f(){return(0,i.patchFetch)({serverHooks:A,staticGenerationAsyncStorage:g})}},5456:(e,r,n)=>{n.d(r,{Gv:()=>a,RA:()=>l,WX:()=>u,c_:()=>i});var t=n(8691),o=n(1482),s=n.n(o);let i=async e=>t.ZP.hash(e,12),a=async(e,r)=>t.ZP.compare(e,r),l=e=>{let r=process.env.JWT_SECRET||"tournament-secret-key-2024-fallback";return s().sign({userId:e},r,{expiresIn:"7d"})},u=e=>{try{let r=process.env.JWT_SECRET||"tournament-secret-key-2024-fallback";return s().verify(e,r)}catch{return null}}},728:(e,r,n)=>{n.d(r,{_:()=>s});let t=require("@prisma/client"),o=globalThis;process.env.DATABASE_URL||(console.error("❌ DATABASE_URL environment variable is not set!"),console.log("\uD83D\uDD27 Please set DATABASE_URL in your Render environment variables"));let s=o.prisma??new t.PrismaClient({})}};var r=require("../../../../webpack-runtime.js");r.C(e);var n=e=>r(r.s=e),t=r.X(0,[8948,5972,1482,8691],()=>n(9942));module.exports=t})();